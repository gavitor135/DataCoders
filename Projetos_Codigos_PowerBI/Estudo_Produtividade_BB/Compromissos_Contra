SELECT
    FP.PASTA,
    FP.PRODUTO,
    FP.CARTEIRA,
    FP.STATUS_PASTA,
    FP.RESPONSAVEL_1,
    FP.DATA_DO_AJUIZAMENTO,
    COMP.TIPO_COMPROMISSO,
    COMP.CHAVECOMP,
    YEAR(COMP.DATA_LIMITE_COMPROMISSO) AS ANO_LIMITE,
    MONTH(COMP.DATA_LIMITE_COMPROMISSO) AS MES_LIMITE,
    COMP.DATA_LIMITE_COMPROMISSO,
    COMP.DATA_CONCLUSAO_COMPROMISSO,
    CAST(COMP.DATA_CONCLUSAO_COMPROMISSO AS DATE) AS DATA_CONCLUSAO_SEM_HORA,
    FORMAT(COMP.DATA_CONCLUSAO_COMPROMISSO,'HH') AS HORA_CONCLUSAO,
    COMP.USUARIO_CONCLUSAO_COMPROMISSO,
    COMP.RESPONSAVEL_1_COMPROMISSO,
    COMP.STATUS_COMPROMISSO,

CASE 
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IS NULL
    THEN COMP.RESPONSAVEL_1_COMPROMISSO
ELSE COMP.USUARIO_CONCLUSAO_COMPROMISSO
END AS USUARIO_RESPONSAVEL_COMPROMISSOS,

CASE 
    WHEN COMP.STATUS_COMPROMISSO = 'CONCLUÍDO' 
         AND COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
        'DANIELE OTHON DE ALMEIDA',
        'JOAO PEDRO STABILE',
        'GISLAINE DE SOUZA FREITAS',
        'FABIO LUIZ ALVES DA SILVA JUNIOR',
        'DALLILA VALENTIN RODRIGUES',
        'LEONARDO SALVADOR LEMOS DE MELLO',
        'JORGE MARCIO NUNES JUNIOR',
        'ANDRE LUIS DE CARVALHO',
        'RENATA LIMA DOMINGUES',
        'ISABELA RIBEIRO CHARABA',
        'BRUNO CHIQUETTI',
        'RODRIGO RIBEIRO PEREIRA',
        'VIVIANE RODRIGUES',
        'ARTUR HAINES',
        'RAFAEL DONIZETE DE SOUZA LIMA',
        'ISABELLA TONETTO PESSICA',
        'SCHEILLAN TEREZINHA KRUG MACHADO',
        'FLAVIA COUTO DE MORAIS',
        'CAIO CLEMENTE RODRIGUES GOMES',
        'NICOLY DE OLIVEIRA DOS SANTOS',
        'NATALIA MIATTELLO RUFFO',
        'JULIANA DE SANTANA TORESANI',
        'DOUGLAS ALBUQUERQUE SCHROEDER',
        'MARIA EUGENIA TRINDADE DA SILVA PORTES',
        'NATHALIA PEDROZA BATISTA LOPES',
        'BRENA GONCALVES COSTA DE SA',
        'AMANDA DA SILVA PEREIRA',
        'BRUNA CAROLINE DE SOUZA OLIVEIRA',
        'FLAVIA CARVALHAES MOREIRA',
        'VINICIUS DE OLIVEIRA NATALINO',
        'DANIELLA GUERRA ANDRADE',
        'MARILIA SANDRIN NASCIMENTO',
        'GISLENE SAMPAIO SAID',
        'VINICIUS BERGANTINI PAREDE',
        'FELIPE ANTHONY REIS NUNES',
        'RAFAEL MENDES ZACARIAS',
        'ERICA VITORIA NOVAIS DE SOUZA',
        'LUIS ARTHUR CAPELLI PEDROZO',
        'MATHEUS DE CARVALHO NERY',
        'PABLO DIEGO ALVES CERQUEIRA PINTO',
        'STEPHANIE CAMILA BITENCOURT GOMES DO PRADO',
        'THAIS HERNEQUE'
         ) THEN 'COLABORADORES CLICIA'
    WHEN COMP.STATUS_COMPROMISSO = 'PENDENTE' 
         AND COMP.RESPONSAVEL_1_COMPROMISSO IN (
        'DANIELE OTHON DE ALMEIDA',
        'JOAO PEDRO STABILE',
        'GISLAINE DE SOUZA FREITAS',
        'FABIO LUIZ ALVES DA SILVA JUNIOR',
        'DALLILA VALENTIN RODRIGUES',
        'LEONARDO SALVADOR LEMOS DE MELLO',
        'JORGE MARCIO NUNES JUNIOR',
        'ANDRE LUIS DE CARVALHO',
        'RENATA LIMA DOMINGUES',
        'ISABELA RIBEIRO CHARABA',
        'BRUNO CHIQUETTI',
        'RODRIGO RIBEIRO PEREIRA',
        'VIVIANE RODRIGUES',
        'ARTUR HAINES',
        'RAFAEL DONIZETE DE SOUZA LIMA',
        'ISABELLA TONETTO PESSICA',
        'SCHEILLAN TEREZINHA KRUG MACHADO',
        'FLAVIA COUTO DE MORAIS',
        'CAIO CLEMENTE RODRIGUES GOMES',
        'NICOLY DE OLIVEIRA DOS SANTOS',
        'NATALIA MIATTELLO RUFFO',
        'JULIANA DE SANTANA TORESANI',
        'DOUGLAS ALBUQUERQUE SCHROEDER',
        'MARIA EUGENIA TRINDADE DA SILVA PORTES',
        'NATHALIA PEDROZA BATISTA LOPES',
        'BRENA GONCALVES COSTA DE SA',
        'AMANDA DA SILVA PEREIRA',
        'BRUNA CAROLINE DE SOUZA OLIVEIRA',
        'FLAVIA CARVALHAES MOREIRA',
        'VINICIUS DE OLIVEIRA NATALINO',
        'DANIELLA GUERRA ANDRADE',
        'MARILIA SANDRIN NASCIMENTO',
        'GISLENE SAMPAIO SAID',
        'VINICIUS BERGANTINI PAREDE',
        'FELIPE ANTHONY REIS NUNES',
        'RAFAEL MENDES ZACARIAS',
        'ERICA VITORIA NOVAIS DE SOUZA',
        'LUIS ARTHUR CAPELLI PEDROZO',
        'MATHEUS DE CARVALHO NERY',
        'PABLO DIEGO ALVES CERQUEIRA PINTO',
        'STEPHANIE CAMILA BITENCOURT GOMES DO PRADO',
        'THAIS HERNEQUE'
         ) THEN 'COLABORADORES CLICIA'
    ELSE 'DEMAIS COLABORADORES'
END AS "VERIFICAÇÃO DE TIME",

CASE 
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
            'CARLA VIEIRA DE LIMA',
            'CARLOS EDUARDO PEREIRA',
            'KATHIUSSA TAINARA ROSA PEREIRA',
            'LEANDRO HENRIQUE PEREIRA DE SOUZA')
        THEN 'PRAZOS'
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
            'BARBARA VICENTE DE GOUVEIA',
            'FERNANDA LUIZA CRISPIM',
            'ISABELA RODRIGUES MARTINS',
            'JOAO PEDRO JUNQUEIRA BORDUCHI',
            'MARIA EDUARDA CASTRO CORREA',
            'MARIANA FERNANDES ESTIVALET',
            'VICTOR VINÍCIUS OSTERNACK JEDE',
            'JADY SANTOS IZAIAS')
        THEN 'ANDAMENTO PROCESSUAL'
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
            'ANDREIA SILVA DE TOLEDO',
            'ISABELLA GARCIA CAMPOS',
            'AMANDA FALCHETTI')
        THEN 'VISTAGEM - BB AUTOR'
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
            'INGRIDI AIALA FELIPE DOS SANTOS',
            'JEISLEY KARINE CORTEZ PRUDENCIO DE SOUZA',
            'PIETRA MARQUES DE GODOY',
            'RAFAEL JOSE ANDREOTTI',
            'ISABELA ELOIZA DA SILVA MANTEIGA',
            'TATIANE APARECIDA NICOLAU')
        THEN 'CITAÇÃO'
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
            'ITHALO RENNAN JERONIMO',
            'MARIA CAROLINI PUJOLLI',
            'FERNANDA BECK MORA BATISTA',
            'ARYELA MARIA KASZAS DE OLIVEIRA',
            'LEONARDO BORGES MOREIRA',
            'MILDRANTH CLODIS SOUZA GONÇALVES')
        THEN 'CONDUÇÃO PROCESSUAL SUDESTE'
    WHEN COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
            'OLLAVO D CASSIO DIONISIO BERGAME',
            'THIAGO HENRIQUE LIMA',
            'MARINA FERREIRA THOMÉ MAZZOLLA',
            'MILENA RISSI BOSSOLANI FELIPE',
            'VITORIA PEREIRA SOARES')
        THEN 'AJUIZAMENTO'
    -- Verificação do RESPONSAVEL_1_COMPROMISSO caso USUARIO_CONCLUSAO_COMPROMISSO seja nulo ou não esteja na lista
    WHEN COMP.RESPONSAVEL_1_COMPROMISSO IN (
            'CARLA VIEIRA DE LIMA',
            'CARLOS EDUARDO PEREIRA',
            'KATHIUSSA TAINARA ROSA PEREIRA',
            'LEANDRO HENRIQUE PEREIRA DE SOUZA')
        THEN 'PRAZOS'
    WHEN COMP.RESPONSAVEL_1_COMPROMISSO IN (
            'BARBARA VICENTE DE GOUVEIA',
            'FERNANDA LUIZA CRISPIM',
            'ISABELA RODRIGUES MARTINS',
            'JOAO PEDRO JUNQUEIRA BORDUCHI',
            'MARIA EDUARDA CASTRO CORREA',
            'MARIANA FERNANDES ESTIVALET',
            'VICTOR VINÍCIUS OSTERNACK JEDE',
            'JADY SANTOS IZAIAS')
        THEN 'ANDAMENTO PROCESSUAL'
    WHEN COMP.RESPONSAVEL_1_COMPROMISSO IN (
            'ANDREIA SILVA DE TOLEDO',
            'ISABELLA GARCIA CAMPOS',
            'AMANDA FALCHETTI')
        THEN 'VISTAGEM - BB AUTOR'
    WHEN COMP.RESPONSAVEL_1_COMPROMISSO IN (
            'INGRIDI AIALA FELIPE DOS SANTOS',
            'JEISLEY KARINE CORTEZ PRUDENCIO DE SOUZA',
            'PIETRA MARQUES DE GODOY',
            'RAFAEL JOSE ANDREOTTI',
            'ISABELA ELOIZA DA SILVA MANTEIGA',
            'TATIANE APARECIDA NICOLAU')
        THEN 'CITAÇÃO'
    WHEN COMP.RESPONSAVEL_1_COMPROMISSO IN (
            'ITHALO RENNAN JERONIMO',
            'MARIA CAROLINI PUJOLLI',
            'FERNANDA BECK MORA BATISTA',
            'ARYELA MARIA KASZAS DE OLIVEIRA',
            'LEONARDO BORGES MOREIRA',
            'MILDRANTH CLODIS SOUZA GONÇALVES')
        THEN 'CONDUÇÃO PROCESSUAL SUDESTE'
    WHEN COMP.RESPONSAVEL_1_COMPROMISSO IN (
            'OLLAVO D CASSIO DIONISIO BERGAME',
            'THIAGO HENRIQUE LIMA',
            'MARINA FERREIRA THOMÉ MAZZOLLA',
            'MILENA RISSI BOSSOLANI FELIPE',
            'VITORIA PEREIRA SOARES')
        THEN 'AJUIZAMENTO'
    ELSE 'OUTROS'
END AS 'SUBNUCLEO',

CASE 
    WHEN COMP.DATA_CONCLUSAO_COMPROMISSO > COMP.DATA_LIMITE_COMPROMISSO
    THEN 'CONCLUÍDO - LEGADO'
    WHEN COMP.DATA_CONCLUSAO_COMPROMISSO = COMP.DATA_LIMITE_COMPROMISSO
    THEN 'CONCLUÍDO - DIA'
    WHEN COMP.DATA_CONCLUSAO_COMPROMISSO < COMP.DATA_LIMITE_COMPROMISSO
    THEN 'CONCLUÍDO - FUTURO'
    ELSE 'OUTROS'
    END AS 'CLASSIFICAÇÃO_CONCLUSAO'

FROM JURIDICO.FichaProcessual FP WITH(NOLOCK)
INNER JOIN JURIDICO.Compromissos COMP WITH(NOLOCK) ON FP.PASTA = COMP.PASTA
WHERE FP.PRODUTO IN ('BANCO DO BRASIL - COBRANÇA - SEGMENTO 1',
            'BANCO DO BRASIL - COBRANÇA - SEGMENTO 2',
            'BANCO DO BRASIL - COBRANÇA - SEGMENTO 3',
            'BB - COBRANÇA',
            'BANCO DO BRASIL - COBRANÇA - ATIPICAS')
AND COMP.DATA_LIMITE_COMPROMISSO >= '01/01/2024'
