WITH FICHAFILTRADA AS (
    SELECT
        FP.PASTA,
        FP.PRODUTO
    FROM JURIDICO.FICHAPROCESSUAL FP WITH(NOLOCK)
    WHERE FP.PRODUTO IN (
        'BANCO DO BRASIL - COBRANÇA - SEGMENTO 1',
        'BANCO DO BRASIL - COBRANÇA - SEGMENTO 2',
        'BANCO DO BRASIL - COBRANÇA - SEGMENTO 3',
        'BB - COBRANÇA',
        'BANCO DO BRASIL - COBRANÇA - ATIPICAS'
    )
),
ANDAMENTOSFILTRADOS AS (
    SELECT
        AN.PASTA,
        AN.TIPO_ANDAMENTO AS TIPO,
        AN.DATA_ANDAMENTO AS DATA_EVENTO,
        AN.USUARIO_CADASTRO_ANDAMENTO AS USUARIO,
        'ANDAMENTO' AS ORIGEM
    FROM JURIDICO.ANDAMENTOS AN WITH(NOLOCK)
    INNER JOIN FICHAFILTRADA FP ON AN.PASTA = FP.PASTA
    WHERE AN.DATA_ANDAMENTO >= '01/08/2024'
    AND AN.USUARIO_CADASTRO_ANDAMENTO IN (
        'ARYELA MARIA KASZAS DE OLIVEIRA',
        'BARBARA VICENTE DE GOUVEIA',
        'FERNANDA BECK MORA BATISTA',
        'FERNANDA LUIZA CRISPIM',
        'ISABELA RODRIGUES MARTINS',
        'JOAO PEDRO JUNQUEIRA BORDUCHI',
        'LEONARDO BORGES MOREIRA',
        'MARIA CAROLINI PUJOLLI',
        'MARIA EDUARDA CASTRO CORREA',
        'MARIANA FERNANDES ESTIVALET',
        'MILDRANTH CLODIS SOUZA GONÇALVES',
        'VICTOR VINÍCIUS OSTERNACK JEDE'
    )
),
COMPROMISSOSFILTRADOS AS (
    SELECT
        COMP.PASTA,
        COMP.TIPO_COMPROMISSO AS TIPO,
        COMP.DATA_CONCLUSAO_COMPROMISSO AS DATA_EVENTO,
        COMP.USUARIO_CONCLUSAO_COMPROMISSO AS USUARIO,
        'COMPROMISSO' AS ORIGEM
    FROM JURIDICO.COMPROMISSOS_CONCLUIDOS COMP WITH(NOLOCK)
    INNER JOIN FICHAFILTRADA FP ON COMP.PASTA = FP.PASTA
    WHERE COMP.DATA_CONCLUSAO_COMPROMISSO >= '01/08/2024'
    AND COMP.USUARIO_CONCLUSAO_COMPROMISSO IN (
        'ARYELA MARIA KASZAS DE OLIVEIRA',
        'BARBARA VICENTE DE GOUVEIA',
        'FERNANDA BECK MORA BATISTA',
        'FERNANDA LUIZA CRISPIM',
        'ISABELA RODRIGUES MARTINS',
        'JOAO PEDRO JUNQUEIRA BORDUCHI',
        'LEONARDO BORGES MOREIRA',
        'MARIA CAROLINI PUJOLLI',
        'MARIA EDUARDA CASTRO CORREA',
        'MARIANA FERNANDES ESTIVALET',
        'MILDRANTH CLODIS SOUZA GONÇALVES',
        'VICTOR VINÍCIUS OSTERNACK JEDE'
    )
)

-- Unifica os dados
SELECT *
FROM ANDAMENTOSFILTRADOS

UNION ALL

SELECT *
FROM COMPROMISSOSFILTRADOS;


